---
layout: default
title: 'Bitcoin: Un Sistema de Dinero en Efectivo Electrónico Peer­-to­-Peer'
parent: Bitcoin White Paper
nav_order: 2
search_exclude: true
---

# Bitcoin White Paper
{: .no_toc }

Just the Docs has some specific configuration parameters that can be defined in your Jekyll site's _config.yml file.
{: .fs-6 .fw-300 }

## Table of contents
{: .no_toc .text-delta }

- TOC
{:toc}

---

# Bitcoin: Un Sistema de Dinero en Efectivo Electrónico Peer­-to­-PeerBitcoin: A Peer-to-Peer Electronic Cash System
{: .no_toc }

## Resumen

Una forma de dinero en efectivo electrónico puramente peer-to-peer debería permitir enviar pagos online directamente entre las partes y sin pasar a través de una institución financiera. Las firmas digitales son parte de la solución, pero los beneficios principales desaparecen si un tercero de confianza sigue siendo imprescindible para prevenir el doble gasto. Proponemos una solución para el problema del doble gasto usando una red peer-to-peer. La red sella las transacciones en el tiempo en una cadena continua de proof-of-work basada en hash, estableciendo un registro que no se puede modificar sin rehacer la proof-of-work. La cadena más larga no solo sirve de prueba efectiva de la secuencia de eventos, sino que también demuestra que procede del conjunto de CPU más potente. Mientras la mayoría de la potencia CPU esté controlada por nodos que no cooperen para atacar la propia red, se generará la cadena más larga y se aventajará a los atacantes. La red en sí misma precisa de una estructura mínima. Los mensajes se transmiten en base a “mejor esfuerzo”, y los nodos pueden abandonar la red y regresar a ella a voluntad, aceptando la cadena proof-of-work más larga como prueba de lo que ha sucedido durante su ausencia.

## 1. Introducción

El comercio en Internet ha llegado a depender casi exclusivamente de las instituciones financieras como terceros de confianza en el proceso de los pagos electrónicos. A pesar de que el sistema funciona suficientemente bien en la mayor parte de las transacciones, sufre la debilidad inherente al modelo basado en confianza. Las transacciones completamente irreversibles no son posibles debido a que las instituciones financieras no pueden evitar mediar en las disputas. El coste de esta mediación incrementa los costes de transacción, limitando su tamaño mínimo útil y eliminando la posibilidad de realizar pequeñas transacciones ocasionales, y hay un coste mayor al perderse la posibilidad de hacer transacciones irreversibles para servicios irreversibles. Con la posibilidad de ser reversible, la necesidad de confianza crece. Los comerciantes deben tener precaución con sus clientes, solicitándoles más datos de los que de otra forma serían necesarios. Se acepta como inevitable un cierto porcentaje de fraude. Esos costes y la incertidumbre en los pagos se pueden evitar cuando se usa dinero físico en persona, pero no existe mecanismo que permita realizar pagos a través de un canal de comunicación sin la participación de un tercero de confianza.

Es necesario, por tanto, un sistema de pago electrónico basado en prueba criptográfica en lugar de confianza, permitiendo que dos partes interesadas realicen transacciones directamente entre ellas, sin necesidad de un tercero de confianza. Si las transacciones son computacionalmente imposibles de revertir, protegerán a los vendedores del fraude, y cualquier mecanismo de depósito de garantía se puede implementar fácilmente para proteger al comprador. En este documento proponemos una solución al problema del doble gasto usando un servidor de sellado de tiempo, distribuido y peer-to-peer, para generar la prueba computacional del orden cronológico de las transacciones. El sistema es seguro mientras los nodos honestos controlen colectivamente más potencia CPU que cualquier grupo cooperante de nodos atacantes.

## 2. Transacciones

Definimos una moneda electrónica como una cadena de firmas digitales. Cada propietario transfiere la moneda al siguiente propietario firmando digitalmente un hash de la transacción previa y la clave pública del siguiente propietario, y añadiendo ambos al final de la moneda. El beneficiario puede verificar las firmas para verificar la cadena de propiedad.

<p><img loading="lazy" class=" wp-image-227 aligncenter" src="https://nakamotostudies.org/wp-content/uploads/2018/05/Transactions.png" alt="" width="491" height="293" srcset="https://nakamotostudies.org/wp-content/uploads/2018/05/Transactions.png 694w, https://nakamotostudies.org/wp-content/uploads/2018/05/Transactions-300x179.png 300w" sizes="(max-width: 491px) 100vw, 491px"></p>

El problema, por supuesto, es que el beneficiario no puede verificar que uno de los propietarios no haya gastado dos veces la misma moneda. La solución habitual es introducir una autoridad central de confianza, o casa de la moneda, que comprueba cada transacción para que eso no se produzca. Tras cada transacción, la moneda debe regresar a la casa de la moneda para distribuir una nueva moneda, y solo las monedas emitidas directamente desde ella están libres de la sospecha de doble gasto. El problema de esta solución es que el destino de todo el sistema de dinero depende de la compañía que gestiona la casa de la moneda, por la cual pasa cada transacción, igual que un banco.

Necesitamos una forma de que el beneficiario sepa que los propietarios previos no han firmado transacciones anteriores. Para nuestros propósitos, la transacción más temprana es la que cuenta, así que no nos preocupamos de los intentos de doble gasto posteriores. La única manera de confirmar la ausencia de una transacción es tener conocimiento de todas las transacciones. En el modelo de la casa de la moneda, esta tiene conocimiento de todas las transacciones y decide cuáles llegaron primero. Para lograr esto sin la participación de una parte de confianza, las transacciones han de ser anunciadas públicamente [1], y necesitamos un sistema para que los participantes estén de acuerdo en un único historial del orden en que fueron recibidas. El beneficiario necesita prueba de que en el momento de la transacción la mayor parte de los nodos estaban de acuerdo en que esa fue la primera que se recibió.

## 3. Servidor de Sellado de Tiempo

La solución que proponemos comienza con un servidor de sellado de tiempo. Un servidor de sellado de tiempo trabaja tomando el hash de un bloque de ítems para sellarlos en el tiempo y notificar públicamente su hash, como un periódico o un post Usenet [2-5]. El sellado de tiempo prueba que los datos han existido en el tiempo, obviamente, para entrar en el hash. Cada sellado de tiempo incluye el sellado de tiempo previo en su hash, formando una cadena, con cada sellado de tiempo adicional reforzando al que estaba antes.

<p><img loading="lazy" class="aligncenter wp-image-228" src="https://nakamotostudies.org/wp-content/uploads/2018/05/Timestamp.png" alt="" width="491" height="127" srcset="https://nakamotostudies.org/wp-content/uploads/2018/05/Timestamp.png 628w, https://nakamotostudies.org/wp-content/uploads/2018/05/Timestamp-300x78.png 300w" sizes="(max-width: 491px) 100vw, 491px"></p>

## 4. Proof-of-Work

Para implementar un servidor de sellado de tiempo distribuido de forma peer-to-peer, necesitaremos emplear un sistema de proof-of-work similar al Hashcash de Adam Back [6], más que al de los periódicos o los post Usenet. La proof-of-work consiste en escanear en busca de un valor que cuando fue hasheado, al igual que con SHA-256, el hash comience con un número de cero bits. El trabajo medio que hace falta es exponencial en el número de cero bits requeridos y puede verificarse ejecutando un único hash.

Para nuestra red de sellado de tiempo, implementamos la proof-of-work incrementando un nonce5 en el bloque hasta que se encuentre un valor que dé al hash del bloque los cero bits requeridos. Una vez que se ha agotado el esfuerzo de CPU para satisfacer la proof-of-work, el bloque no se puede cambiar sin rehacer el trabajo. A medida que bloques posteriores se encadenen tras él, el trabajo para cambiar un bloque incluiría rehacer todos los bloques anteriores.

<p><img loading="lazy" class="aligncenter wp-image-229" src="https://nakamotostudies.org/wp-content/uploads/2018/05/Proof-of-Work.png" alt="" width="491" height="114" srcset="https://nakamotostudies.org/wp-content/uploads/2018/05/Proof-of-Work.png 639w, https://nakamotostudies.org/wp-content/uploads/2018/05/Proof-of-Work-300x69.png 300w" sizes="(max-width: 491px) 100vw, 491px"></p>

La proof-of-work también resuelve el problema de determinar la representación en la toma de decisiones mayoritarias. Si la mayoría estuviera basada en un voto por IP, podría subvertirse por cualquiera capaz de asignar muchas IPs. La proof-of-work es esencialmente un voto por CPU. La decisión de la mayoría está representada por la cadena más larga, en la cual se ha invertido el mayor esfuerzo de proof-of-work. Si la mayoría de la potencia CPU está controlada por nodos honestos, la cadena honesta crecerá más rápido y dejará atrás cualquier cadena que compita. Para modificar un bloque pasado, un atacante tendría que rehacer la proof-of-work del bloque y de todos los bloques posteriores, y entonces alcanzar el trabajo de los nodos honestos. Demostraremos más adelante que la probabilidad de que un atacante más lento los alcance, disminuye exponencialmente a medida que se añaden bloques posteriores.

Para compensar el aumento en la velocidad del hardware y el interés variable de los nodos activos a lo largo del tiempo, la dificultad de la proof-of-work está determinada por una media móvil que apunta a un número medio de bloques por hora. Si se generan muy deprisa, la dificultad aumenta.

## 5. Red

Los pasos para ejecutar la red son los siguientes:

1. Las transacciones nuevas se transmiten a todos los nodos.
2. Cada nodo recoge todas las transacciones en un bloque.
3. Cada nodo trabaja en resolver una proof-of-work compleja para su bloque.
4. Cuando un nodo resuelve una proof-of-work,transmite el bloque a todos los nodos.
5. Los nodos aceptan el bloque si todas las transacciones en él son válidas y no se han gastado con anterioridad.
8. Los nodos expresan su aceptación del bloque al trabajar en crear el siguiente bloque en la
cadena, usando el hash del bloque aceptado como hash previo.

Los nodos siempre consideran correcta a la cadena más larga y se mantendrán trabajando para extenderla. Si dos nodos transmiten simultáneamente diferentes versiones del siguiente bloque, algunos nodos recibirán una antes que la otra. En ese caso, trabajarán sobre la primera que hayan recibido, pero guardarán la otra ramificación por si acaso se convierte en la más larga. El empate se romperá cuando se encuentre la siguiente proof-of-work y una ramificación se convierta en la más larga; los nodos que trabajaban en la otra ramificación cambiarán automáticamente a la más larga.

La transmisión de nuevas transacciones no precisa alcanzar todos los nodos. Con alcanzar a la mayoría de los nodos, entrarán en un bloque en poco tiempo. Las transmisiones de nodos también toleran mensajes perdidos. Si un nodo no recibe un bloque, lo reclamará cuando reciba el siguiente bloque y se dé cuenta de que falta uno.

## 6. Incentivo

Por convención, la primera transacción en un bloque es una transacción especial con la que comienza una moneda nueva, propiedad del creador del bloque. Esto añade un incentivo a los nodos para soportar la red, y proporciona una forma de poner las monedas en circulación, dado que no hay autoridad central que las distribuya. La adición estable de una constante de monedas nuevas es análoga a los mineros de oro que consumen recursos para añadir oro a la circulación. En nuestro caso, es tiempo de CPU y electricidad lo que se gasta.

El incentivo también se basa en las comisiones por transacción. Si el valor de salida de una transacción es menor que el valor de entrada, la diferencia es una comisión por transacción que se añade al valor de incentivo del bloque que contiene la transacción. Una vez que un número predeterminado de monedas ha entrado en circulación, el incentivo puede evolucionar hacia comisiones de transacción y estar completamente libre de inflación.

El incentivo puede ayudar a que los nodos permanezcan honestos. Si un atacante codicioso fuera capaz de reunir más potencia CPU que la de todos los nodos honestos, tendría que escoger entre usarla para defraudar a la gente robándoles los pagos recibidos, o usarla para generar nuevas monedas. Debe encontrar más rentable respetar las reglas, esas reglas que le favorecen entregándole más monedas nuevas que a todos los demás en conjunto, que socavar el sistema y la validez de su propia riqueza.

## 7. Recuperación de espacio de disco

Cuando la última transacción de una moneda está enterrada bajo suficientes bloques, las transacciones que se han gastado antes que ella se pueden descartar para ahorrar espacio de disco. Para facilitar esto sin romper el hash del bloque, las transacciones son hasheadas en un Árbol de Merkle [7][2][5], incluyendo solo la raíz en el hash del bloque. Los bloques viejos pueden compactarse podando ramas del árbol. Los hashes interiores no necesitan ser guardados.

<p><img loading="lazy" class="aligncenter wp-image-230" src="https://nakamotostudies.org/wp-content/uploads/2018/05/Recaiming-Disk-Space.png" alt="" width="491" height="269" srcset="https://nakamotostudies.org/wp-content/uploads/2018/05/Recaiming-Disk-Space.png 800w, https://nakamotostudies.org/wp-content/uploads/2018/05/Recaiming-Disk-Space-300x164.png 300w, https://nakamotostudies.org/wp-content/uploads/2018/05/Recaiming-Disk-Space-768x420.png 768w" sizes="(max-width: 491px) 100vw, 491px"></p>

Una cabecera de bloque sin transacciones pesaría unos 80 bytes. Si suponemos que los bloques se generan cada 10 minutos, 80 bytes × 6 × 24 × 365 = 4.2MB por año. Siendo habitual la venta de ordenadores con 2GB de RAM en 2008, y con la Ley de Moore prediciendo un crecimiento de 1.2GB anual, el almacenamiento no debería suponer un problema incluso si hubiera que conservar en la memoria las cabeceras de bloque.

## 8. Verificación de pagos simplificada

Es posible verificar pagos sin ejecutar un nodo plenamente en red. El usuario solo necesita tener una copia de las cabeceras de bloque de la cadena más larga de proof-of-work, que puede conseguir solicitándola a los nodos de red hasta estar convencido de que tiene la cadena más larga, y obtener la rama Merkle que enlaza la transacción con el bloque en que está sellado en el tiempo. El usuario no puede comprobar la transacción por sí mismo pero, al enlazarla a un lugar en la cadena, puede ver que un nodo de la red la ha aceptado, y los bloques añadidos posteriormente confirman además que la red la ha aceptado.

<p><img loading="lazy" class="aligncenter wp-image-232" src="https://nakamotostudies.org/wp-content/uploads/2018/05/Simplified-Payment-Verification.png" alt="" width="491" height="208" srcset="https://nakamotostudies.org/wp-content/uploads/2018/05/Simplified-Payment-Verification.png 1008w, https://nakamotostudies.org/wp-content/uploads/2018/05/Simplified-Payment-Verification-300x127.png 300w, https://nakamotostudies.org/wp-content/uploads/2018/05/Simplified-Payment-Verification-768x325.png 768w" sizes="(max-width: 491px) 100vw, 491px"></p>

Como tal, la verificación es fiable en tanto que los nodos honestos controlen la red, pero es más vulnerable si un atacante domina la red. Mientras que los nodos de red pueden verificar las transacciones por sí mismos, el método simplificado puede ser engañado por transacciones fabricadas por un atacante, en tanto el atacante pueda continuar dominando la red. Una estrategia para protegerse contra esto podría ser aceptar alertas de los nodos de red cuando detecten un bloque no válido, sugiriendo al software del usuario que descargue el bloque entero y las transacciones con aviso para confirmar la inconsistencia. Los negocios que reciban pagos con frecuencia seguramente preferirán tener sus propios nodos ejecutándose para tener más seguridad independiente y verificación más rápida.

## 9. Combinando y dividiendo valor

Aunque sería posible manipular monedas individualmente, no sería manejable hacer una transacción para cada céntimo en una transferencia. Para permitir que el valor se divida y combine, las transacciones contienen múltiples entradas y salidas. Normalmente habrá, o bien una entrada simple de una transacción anterior mayor, o bien múltiples entradas combinando pequeñas cantidades, y como máximo dos salidas: una para el pago y otra devolviendo el cambio, si lo hubiera, al emisor.

<p><img loading="lazy" class="size-full wp-image-233 aligncenter" src="https://nakamotostudies.org/wp-content/uploads/2018/05/Combining-and-Splitting-Value.png" alt="" width="304" height="183" srcset="https://nakamotostudies.org/wp-content/uploads/2018/05/Combining-and-Splitting-Value.png 304w, https://nakamotostudies.org/wp-content/uploads/2018/05/Combining-and-Splitting-Value-300x181.png 300w" sizes="(max-width: 304px) 100vw, 304px"></p>

Cabe señalar que la diseminación de control6, donde una transacción depende de varias transacciones, y esas transacciones dependen de muchas más, no supone aquí un problema. No existe la necesidad de extraer una copia completa e independiente del historial de una transacción.

## 10. Privacidad

El modelo tradicional de banca consigue un nivel de privacidad limitando el acceso a la información a las partes implicadas y el tercero de confianza. La necesidad de anunciar públicamente todas las transacciones excluye este método, pero aún así se puede mantener la privacidad rompiendo el flujo de información en otro punto: manteniendo las claves públicas anónimas. El público puede ver que alguien está enviando una cantidad a otro alguien, pero sin que haya información vinculando la transacción con nadie. Esto es similar al nivel de información que comunican las bolsas de valores, donde el tiempo y tamaño de las operaciones individuales, la “cinta”, son hechos públicos, pero sin decir quiénes fueron las partes.

<p><img loading="lazy" class="aligncenter wp-image-234" src="https://nakamotostudies.org/wp-content/uploads/2018/05/Privacy.png" alt="" width="492" height="146" srcset="https://nakamotostudies.org/wp-content/uploads/2018/05/Privacy.png 810w, https://nakamotostudies.org/wp-content/uploads/2018/05/Privacy-300x89.png 300w, https://nakamotostudies.org/wp-content/uploads/2018/05/Privacy-768x229.png 768w" sizes="(max-width: 492px) 100vw, 492px"></p>

Como cortafuegos adicional, debería usarse un nuevo par de claves en cada transacción para evitar que se relacionen con un propietario común. Con las transacciones multientrada será inevitable algún tipo de vinculación, pues revelan necesariamente que sus entradas pertenecieron al mismo propietario. El riesgo es que si se revela la identidad del propietario de una clave, la vinculación podría revelar otras transacciones que pertenecieron al mismo propietario.

## 11. Cálculos

Consideramos el escenario de un atacante intentando generar una cadena alternativa más rápido que la cadena honesta. Incluso si se consigue, el sistema no queda abierto a cambios arbitrarios como crear valor de la nada o tomar dinero que nunca perteneció al atacante. Los nodos no van a aceptar una transacción inválida como pago y los nodos honestos nunca aceptarán un bloque que las contenga. Un atacante solo puede tratar de cambiar una de sus propias transacciones para recuperar dinero que ha gastado recientemente.

La carrera entre la cadena honesta y la cadena de un atacante puede verse como un paseo aleatorio binomial7. El suceso que prospera es la cadena honesta creciendo un bloque, aumentando su liderato por +1, y el suceso que fracasa es la cadena del atacante creciendo un bloque, reduciendo la brecha en -1.

La probabilidad de que un ataque alcance [la cadena honesta] desde un déficit dado es análoga al problema de la ruina del jugador8. Supongamos que un jugador con crédito ilimitado comienza con un déficit y juega en potencia un número infinito de intentos para alcanzar un punto de equilibrio. Podemos calcular la probabilidad de que alcance ese punto, o de que un ataque alcance alguna vez a la cadena honesta, como sigue [8]:

<span class="math" id="MathJax-Span-1" style="width: 31.804em; display: inline-block;"><span style="display: inline-block; position: relative; width: 28.387em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(-0.163em, 1028.22em, 4.191em, -999.997em); top: -2.257em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mtable" id="MathJax-Span-3" style="padding-right: 0.168em; padding-left: 0.168em;"><span style="display: inline-block; position: relative; width: 28.056em; height: 0px;"><span style="position: absolute; clip: rect(2.648em, 1001.16em, 6.782em, -999.997em); top: -4.847em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.16em; height: 0px;"><span style="position: absolute; clip: rect(3.255em, 1000.66em, 4.467em, -999.997em); top: -5.509em; right: 0em;"><span class="mtd" id="MathJax-Span-4"><span class="mrow" id="MathJax-Span-5"><span class="mstyle" id="MathJax-Span-6"><span class="mrow" id="MathJax-Span-7"><span class="mi" id="MathJax-Span-8" style="font-size: 135%; font-family: STIXGeneral-Italic;">p</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span><span style="position: absolute; clip: rect(3.255em, 1000.66em, 4.467em, -999.997em); top: -4.076em; right: 0em;"><span class="mtd" id="MathJax-Span-16"><span class="mrow" id="MathJax-Span-17"><span class="mstyle" id="MathJax-Span-18"><span class="mrow" id="MathJax-Span-19"><span class="mi" id="MathJax-Span-20" style="font-size: 135%; font-family: STIXGeneral-Italic;">q</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span><span style="position: absolute; clip: rect(3.255em, 1001.16em, 4.577em, -999.997em); top: -2.643em; right: 0em;"><span class="mtd" id="MathJax-Span-28"><span class="mrow" id="MathJax-Span-29"><span class="mstyle" id="MathJax-Span-30"><span class="mrow" id="MathJax-Span-31"><span class="msubsup" id="MathJax-Span-32"><span style="display: inline-block; position: relative; width: 1.16em; height: 0px;"><span style="position: absolute; clip: rect(4.302em, 1000.66em, 5.514em, -999.997em); top: -5.068em; left: 0em;"><span class="mi" id="MathJax-Span-33" style="font-size: 135%; font-family: STIXGeneral-Italic;">q</span><span style="display: inline-block; width: 0px; height: 5.073em;"></span></span><span style="position: absolute; top: -3.69em; left: 0.664em;"><span class="mi" id="MathJax-Span-34" style="font-size: 95.5%; font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.853em;"></span></span><span style="position: absolute; clip: rect(2.207em, 1001em, 5.79em, -999.997em); top: -4.241em; left: 1.16em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.475em, 1001em, 4.191em, -999.997em); top: -5.509em; left: 50%; margin-left: -0.493em;"><span class="mtd" id="MathJax-Span-9"><span class="mrow" id="MathJax-Span-10"><span class="mi" id="MathJax-Span-11"></span><span class="mo" id="MathJax-Span-12" style="font-family: STIXGeneral-Regular; padding-left: 0.333em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span><span style="position: absolute; clip: rect(3.475em, 1001em, 4.191em, -999.997em); top: -4.076em; left: 50%; margin-left: -0.493em;"><span class="mtd" id="MathJax-Span-21"><span class="mrow" id="MathJax-Span-22"><span class="mi" id="MathJax-Span-23"></span><span class="mo" id="MathJax-Span-24" style="font-family: STIXGeneral-Regular; padding-left: 0.333em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span><span style="position: absolute; clip: rect(3.475em, 1001em, 4.191em, -999.997em); top: -2.643em; left: 50%; margin-left: -0.493em;"><span class="mtd" id="MathJax-Span-35"><span class="mrow" id="MathJax-Span-36"><span class="mi" id="MathJax-Span-37"></span><span class="mo" id="MathJax-Span-38" style="font-family: STIXGeneral-Regular; padding-left: 0.333em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.247em;"></span></span><span style="position: absolute; clip: rect(2.428em, 1025.58em, 6.506em, -999.997em); top: -4.737em; left: 2.483em;"><span style="display: inline-block; position: relative; width: 25.576em; height: 0px;"><span style="position: absolute; clip: rect(3.199em, 1019.07em, 4.412em, -999.997em); top: -5.509em; left: 0em;"><span class="mtd" id="MathJax-Span-13"><span class="mrow" id="MathJax-Span-14"><span class="mtext" id="MathJax-Span-15" style="font-family: STIXGeneral-Regular;">&nbsp;probability an honest node finds the next block</span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span><span style="position: absolute; clip: rect(3.199em, 1017.7em, 4.412em, -999.997em); top: -4.076em; left: 0em;"><span class="mtd" id="MathJax-Span-25"><span class="mrow" id="MathJax-Span-26"><span class="mtext" id="MathJax-Span-27" style="font-family: STIXGeneral-Regular;">&nbsp;probability the attacker finds the next block</span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span><span style="position: absolute; clip: rect(3.199em, 1025.58em, 4.412em, -999.997em); top: -2.643em; left: 0em;"><span class="mtd" id="MathJax-Span-39"><span class="mrow" id="MathJax-Span-40"><span class="mrow" id="MathJax-Span-41"><span class="mtext" id="MathJax-Span-42" style="font-family: STIXGeneral-Regular;">&nbsp;probability the attacker will ever catch up from&nbsp;</span><span class="texatom" id="MathJax-Span-43"><span class="mrow" id="MathJax-Span-44"><span class="mi" id="MathJax-Span-45" style="font-family: STIXGeneral-Italic;">z</span></span></span><span class="mtext" id="MathJax-Span-46" style="font-family: STIXGeneral-Regular;">&nbsp;blocks behind</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.743em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.262em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.034em; border-left: 0px solid; width: 0px; height: 4.633em;"></span></span>

<div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><semantics><mstyle mathsize=&quot;1.2em&quot;><msub><mi>q</mi><mi>z</mi></msub><mo>=</mo><mrow><mo>{</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mn>1</mn></mtd><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;-tex-mathit&quot;>if</mtext></mrow><mspace width=&quot;thickmathspace&quot; /><mi>p</mi><mo>&amp;#x2264;</mo><mi>q</mi></mtd></mtr><mtr><mtd><mo stretchy=&quot;false&quot;>(</mo><mi>q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>p</mi><msup><mo stretchy=&quot;false&quot;>)</mo><mi>z</mi></msup></mtd><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;-tex-mathit&quot;>if</mtext></mrow><mspace width=&quot;thickmathspace&quot; /><mi>p</mi><mo>&amp;gt;</mo><mi>q</mi></mtd></mtr></mtable><mo>}</mo></mrow></mstyle><annotation encoding=&quot;application/x-tex&quot;>      \large q_z = \begin{Bmatrix}				1 &amp;amp; \textit{if}\; p \leq q\\				(q/p)^z &amp;amp; \textit{if}\; p &amp;gt; q				\end{Bmatrix}</annotation></semantics></math>" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-47" style="width: 16.151em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.388em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(3.034em, 1014.17em, 6.672em, -999.997em); top: -5.178em; left: 0em;"><span class="mrow" id="MathJax-Span-48"><span class="semantics" id="MathJax-Span-49"><span class="mstyle" id="MathJax-Span-50"><span class="mrow" id="MathJax-Span-51"><span class="msub" id="MathJax-Span-52"><span style="display: inline-block; position: relative; width: 1.16em; height: 0px;"><span style="position: absolute; clip: rect(4.302em, 1000.66em, 5.514em, -999.997em); top: -5.068em; left: 0em;"><span class="mi" id="MathJax-Span-53" style="font-size: 135%; font-family: STIXGeneral-Italic;">q</span><span style="display: inline-block; width: 0px; height: 5.073em;"></span></span><span style="position: absolute; top: -3.69em; left: 0.664em;"><span class="mi" id="MathJax-Span-54" style="font-size: 95.5%; font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span></span></span><span class="mo" id="MathJax-Span-55" style="font-size: 135%; font-family: STIXGeneral-Regular; padding-left: 0.333em;">=</span><span class="mrow" id="MathJax-Span-56" style="padding-left: 0.444em;"><span class="mo" id="MathJax-Span-57" style="vertical-align: -0.769em;"><span><span style="font-size: 135%; font-family: STIXSizeThreeSym;">{</span></span></span><span class="mtable" id="MathJax-Span-58" style="padding-right: 0.168em; padding-left: 0.168em;"><span style="display: inline-block; position: relative; width: 8.601em; height: 0px;"><span style="position: absolute; clip: rect(2.097em, 1003.09em, 5.459em, -999.997em); top: -4.021em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.089em; height: 0px;"><span style="position: absolute; clip: rect(2.924em, 1000.55em, 4.191em, -999.997em); top: -4.847em; left: 50%; margin-left: -0.328em;"><span class="mtd" id="MathJax-Span-59"><span class="mrow" id="MathJax-Span-60"><span class="mn" id="MathJax-Span-61" style="font-size: 135%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span><span style="position: absolute; clip: rect(2.924em, 1003.09em, 4.467em, -999.997em); top: -3.029em; left: 50%; margin-left: -1.54em;"><span class="mtd" id="MathJax-Span-71"><span class="mrow" id="MathJax-Span-72"><span class="mo" id="MathJax-Span-73" style="font-size: 135%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-74" style="font-size: 135%; font-family: STIXGeneral-Italic;">q</span><span class="texatom" id="MathJax-Span-75"><span class="mrow" id="MathJax-Span-76"><span class="mo" id="MathJax-Span-77" style="font-size: 135%; font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-78" style="font-size: 135%; font-family: STIXGeneral-Italic;">p</span><span class="msup" id="MathJax-Span-79"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.971em, 1000.39em, 5.459em, -999.997em); top: -5.068em; left: 0em;"><span class="mo" id="MathJax-Span-80" style="font-size: 135%; font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 5.073em;"></span></span><span style="position: absolute; top: -4.572em; left: 0.444em;"><span class="mi" id="MathJax-Span-81" style="font-size: 95.5%; font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span><span style="position: absolute; clip: rect(2.097em, 1004.36em, 5.459em, -999.997em); top: -4.021em; left: 4.247em;"><span style="display: inline-block; position: relative; width: 4.357em; height: 0px;"><span style="position: absolute; clip: rect(2.924em, 1004.36em, 4.467em, -999.997em); top: -4.847em; left: 50%; margin-left: -2.147em;"><span class="mtd" id="MathJax-Span-62"><span class="mrow" id="MathJax-Span-63"><span class="texatom" id="MathJax-Span-64"><span class="mrow" id="MathJax-Span-65"><span class="mtext" id="MathJax-Span-66" style="font-size: 135%; font-family: STIXGeneral-Italic;">if</span></span></span><span class="mspace" id="MathJax-Span-67" style="height: 0em; vertical-align: 0em; width: 0.444em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-68" style="font-size: 135%; font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-69" style="font-size: 135%; font-family: STIXGeneral-Regular; padding-left: 0.333em;">≤</span><span class="mi" id="MathJax-Span-70" style="font-size: 135%; font-family: STIXGeneral-Italic; padding-left: 0.333em;">q</span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span><span style="position: absolute; clip: rect(2.924em, 1004.36em, 4.467em, -999.997em); top: -3.029em; left: 50%; margin-left: -2.147em;"><span class="mtd" id="MathJax-Span-82"><span class="mrow" id="MathJax-Span-83"><span class="texatom" id="MathJax-Span-84"><span class="mrow" id="MathJax-Span-85"><span class="mtext" id="MathJax-Span-86" style="font-size: 135%; font-family: STIXGeneral-Italic;">if</span></span></span><span class="mspace" id="MathJax-Span-87" style="height: 0em; vertical-align: 0em; width: 0.444em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-88" style="font-size: 135%; font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-89" style="font-size: 135%; font-family: STIXGeneral-Regular; padding-left: 0.333em;">&gt;</span><span class="mi" id="MathJax-Span-90" style="font-size: 135%; font-family: STIXGeneral-Italic; padding-left: 0.333em;">q</span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span></span></span><span class="mo" id="MathJax-Span-91" style="vertical-align: -0.769em;"><span><span style="font-size: 135%; font-family: STIXSizeThreeSym;">}</span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.184em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.54em; border-left: 0px solid; width: 0px; height: 3.83em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mstyle mathsize="1.2em"><msub><mi>q</mi><mi>z</mi></msub><mo>=</mo><mrow><mo>{</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mtext class="MJX-tex-mathit" mathvariant="-tex-mathit">if</mtext></mrow><mspace width="thickmathspace"></mspace><mi>p</mi><mo>≤</mo><mi>q</mi></mtd></mtr><mtr><mtd><mo stretchy="false">(</mo><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>p</mi><msup><mo stretchy="false">)</mo><mi>z</mi></msup></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mtext class="MJX-tex-mathit" mathvariant="-tex-mathit">if</mtext></mrow><mspace width="thickmathspace"></mspace><mi>p</mi><mo>&gt;</mo><mi>q</mi></mtd></mtr></mtable><mo>}</mo></mrow></mstyle><annotation encoding="application/x-tex">      \large q_z = \begin{Bmatrix}				1 &amp; \textit{if}\; p \leq q\\				(q/p)^z &amp; \textit{if}\; p &gt; q				\end{Bmatrix}</annotation></semantics></math></span></span></div>

Asumiendo que p > q, la probabilidad cae de forma exponencial a medida que aumenta el número de bloques que el atacante tiene que alcanzar. Con las probabilidades en su contra, si no tiene un golpe de suerte que lo haga avanzar desde el principio, sus oportunidades se irán desvaneciendo a medida que se va quedando atrás.

Consideremos ahora cuánto tiempo necesita esperar el receptor de una transacción para tener la suficiente seguridad de que el emisor no puede cambiarla. Asumimos que el emisor es un atacante que quiere que el receptor crea durante un tiempo que le ha pagado; entonces cambiará el pago para devolvérselo a sí mismo un tiempo después. El receptor recibirá un aviso cuando esto suceda, pero el emisor espera que ya sea demasiado tarde.

El receptor genera un nuevo par de claves y da la clave pública al emisor poco antes de firmar. Esto impide que el emisor pueda preparar una cadena de bloques previa trabajando de continuo en ella hasta tener la suerte suficiente como para ponerse a la cabeza y, entonces, ejecutar la transacción. Una vez que la transacción se ha emitido, el emisor deshonesto comienza a trabajar en secreto en una cadena paralela que contiene una versión alternativa de su transacción.

El receptor espera hasta que la transacción se ha añadido al bloque y z bloques se han enlazado tras él. No sabe la cantidad de progreso que ha realizado el atacante, pero asumiendo que los bloques honestos han tomado la media de tiempo esperada por bloque, el potencial de progreso del atacante será una distribución de Poisson9 con un valor esperado:

<div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><semantics><mstyle mathsize=&quot;1.2em&quot;><mi>&amp;#x3BB;</mi><mo>=</mo><mi>z</mi><mfrac><mi>q</mi><mi>p</mi></mfrac></mstyle><annotation encoding=&quot;application/x-tex&quot;>      \large \lambda = z \frac qp</annotation></semantics></math>" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-92" style="width: 4.632em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.136em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.381em, 1004.14em, 4.412em, -999.997em); top: -3.029em; left: 0em;"><span class="mrow" id="MathJax-Span-93"><span class="semantics" id="MathJax-Span-94"><span class="mstyle" id="MathJax-Span-95"><span class="mrow" id="MathJax-Span-96"><span class="mi" id="MathJax-Span-97" style="font-size: 135%; font-family: STIXGeneral-Italic;">λ</span><span class="mo" id="MathJax-Span-98" style="font-size: 135%; font-family: STIXGeneral-Regular; padding-left: 0.333em;">=</span><span class="mi" id="MathJax-Span-99" style="font-size: 135%; font-family: STIXGeneral-Italic; padding-left: 0.333em;">z</span><span class="mfrac" id="MathJax-Span-100"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px; margin-right: 0.168em; margin-left: 0.168em;"><span style="position: absolute; clip: rect(4.302em, 1000.66em, 5.514em, -999.997em); top: -6.005em; left: 50%; margin-left: -0.328em;"><span class="mi" id="MathJax-Span-101" style="font-size: 135%; font-family: STIXGeneral-Italic;">q</span><span style="display: inline-block; width: 0px; height: 5.073em;"></span></span><span style="position: absolute; clip: rect(4.302em, 1000.66em, 5.514em, -999.997em); top: -4.131em; left: 50%; margin-left: -0.328em;"><span class="mi" id="MathJax-Span-102" style="font-size: 135%; font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 5.073em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1000.83em, 1.27em, -999.997em); top: -1.375em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.5px solid; width: 0.829em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.105em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.034em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.417em; border-left: 0px solid; width: 0px; height: 3.151em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mstyle mathsize="1.2em"><mi>λ</mi><mo>=</mo><mi>z</mi><mfrac><mi>q</mi><mi>p</mi></mfrac></mstyle><annotation encoding="application/x-tex">      \large \lambda = z \frac qp</annotation></semantics></math></span></span></div>

Para obtener la probabilidad de que el atacante pueda ponerse al día incluso ahora, multiplicamos la densidad de Poisson para cada aumento en el progreso que podría haber realizado, por la probabilidad que podría haber alcanzado desde ese punto:

<div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><semantics><mstyle mathsize=&quot;1.2em&quot;><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><mfrac><mrow><msup><mi>&amp;#x3BB;</mi><mi>k</mi></msup><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mi>&amp;#x3BB;</mi></mrow></msup></mrow><mrow><mi>k</mi><mo>!</mo></mrow></mfrac><mo>&amp;#x22C5;</mo><mrow><mo>{</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mo stretchy=&quot;false&quot;>(</mo><mi>q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>p</mi><msup><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo>&amp;#x2212;</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></mtd><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;-tex-mathit&quot;>if</mtext></mrow><mspace width=&quot;thickmathspace&quot; /><mi>k</mi><mo>&amp;#x2264;</mo><mi>z</mi></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;-tex-mathit&quot;>if</mtext></mrow><mspace width=&quot;thickmathspace&quot; /><mi>k</mi><mo>&amp;gt;</mo><mi>z</mi></mtd></mtr></mtable><mo>}</mo></mrow></mstyle><annotation encoding=&quot;application/x-tex&quot;>      \large \sum_{k=0}^{\infty} \frac{\lambda^k e^{-\lambda}}{k!} \cdot				\begin{Bmatrix}				(q/p)^{(z-k)} &amp;amp; \textit{if}\;k\leq z\\				1 &amp;amp; \textit{if} \; k &amp;gt; z				\end{Bmatrix}</annotation></semantics></math>" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-103" style="width: 21.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.458em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(2.869em, 1019.24em, 7.057em, -999.997em); top: -5.178em; left: 0em;"><span class="mrow" id="MathJax-Span-104"><span class="semantics" id="MathJax-Span-105"><span class="mstyle" id="MathJax-Span-106"><span class="mrow" id="MathJax-Span-107"><span class="munderover" id="MathJax-Span-108"><span style="display: inline-block; position: relative; width: 1.766em; height: 0px;"><span style="position: absolute; clip: rect(3.585em, 1001.6em, 5.9em, -999.997em); top: -5.068em; left: 0em;"><span class="mo" id="MathJax-Span-109" style="font-size: 135%; font-family: STIXSizeOneSym; vertical-align: -0.548em;">∑</span><span style="display: inline-block; width: 0px; height: 5.073em;"></span></span><span style="position: absolute; clip: rect(3.199em, 1001.55em, 4.357em, -999.997em); top: -2.477em; left: 0.113em;"><span class="texatom" id="MathJax-Span-110"><span class="mrow" id="MathJax-Span-111"><span class="mi" id="MathJax-Span-112" style="font-size: 95.5%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-113" style="font-size: 95.5%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-114" style="font-size: 95.5%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span><span style="position: absolute; clip: rect(3.31em, 1000.83em, 4.191em, -999.997em); top: -5.619em; left: 0.444em;"><span class="texatom" id="MathJax-Span-115"><span class="mrow" id="MathJax-Span-116"><span class="mi" id="MathJax-Span-117" style="font-size: 95.5%; font-family: STIXGeneral-Regular;">∞</span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-118" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 3.089em; height: 0px; margin-right: 0.168em; margin-left: 0.168em;"><span style="position: absolute; clip: rect(2.648em, 1002.98em, 4.191em, -999.997em); top: -4.958em; left: 50%; margin-left: -1.485em;"><span class="mrow" id="MathJax-Span-119"><span class="msup" id="MathJax-Span-120"><span style="display: inline-block; position: relative; width: 1.16em; height: 0px;"><span style="position: absolute; clip: rect(3.971em, 1000.61em, 5.239em, -999.997em); top: -5.068em; left: 0em;"><span class="mi" id="MathJax-Span-121" style="font-size: 135%; font-family: STIXGeneral-Italic;">λ</span><span style="display: inline-block; width: 0px; height: 5.073em;"></span></span><span style="position: absolute; top: -4.572em; left: 0.609em;"><span class="mi" id="MathJax-Span-122" style="font-size: 95.5%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span></span></span><span class="msup" id="MathJax-Span-123"><span style="display: inline-block; position: relative; width: 1.822em; height: 0px;"><span style="position: absolute; clip: rect(4.302em, 1000.55em, 5.239em, -999.997em); top: -5.068em; left: 0em;"><span class="mi" id="MathJax-Span-124" style="font-size: 135%; font-family: STIXGeneral-Italic;">e</span><span style="display: inline-block; width: 0px; height: 5.073em;"></span></span><span style="position: absolute; top: -4.517em; left: 0.609em;"><span class="texatom" id="MathJax-Span-125"><span class="mrow" id="MathJax-Span-126"><span class="mo" id="MathJax-Span-127" style="font-size: 95.5%; font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-128" style="font-size: 95.5%; font-family: STIXGeneral-Italic;">λ</span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span><span style="position: absolute; clip: rect(2.924em, 1000.94em, 4.191em, -999.997em); top: -3.084em; left: 50%; margin-left: -0.548em;"><span class="mrow" id="MathJax-Span-129"><span class="mi" id="MathJax-Span-130" style="font-size: 135%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-131" style="font-size: 135%; font-family: STIXGeneral-Regular;">!</span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1003.09em, 1.27em, -999.997em); top: -1.375em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.5px solid; width: 3.089em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.105em;"></span></span></span></span><span class="mo" id="MathJax-Span-132" style="font-size: 135%; font-family: STIXGeneral-Regular; padding-left: 0.278em;">⋅</span><span class="mrow" id="MathJax-Span-133" style="padding-left: 0.333em;"><span class="mo" id="MathJax-Span-134" style="vertical-align: -0.769em;"><span><span style="font-size: 135%; font-family: STIXSizeThreeSym;">{</span></span></span><span class="mtable" id="MathJax-Span-135" style="padding-right: 0.168em; padding-left: 0.168em;"><span style="display: inline-block; position: relative; width: 10.089em; height: 0px;"><span style="position: absolute; clip: rect(1.877em, 1004.85em, 5.239em, -999.997em); top: -4.021em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.853em; height: 0px;"><span style="position: absolute; clip: rect(2.648em, 1004.85em, 4.467em, -999.997em); top: -4.792em; left: 50%; margin-left: -2.422em;"><span class="mtd" id="MathJax-Span-136"><span class="mrow" id="MathJax-Span-137"><span class="mo" id="MathJax-Span-138" style="font-size: 135%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-139" style="font-size: 135%; font-family: STIXGeneral-Italic;">q</span><span class="texatom" id="MathJax-Span-140"><span class="mrow" id="MathJax-Span-141"><span class="mo" id="MathJax-Span-142" style="font-size: 135%; font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-143" style="font-size: 135%; font-family: STIXGeneral-Italic;">p</span><span class="msup" id="MathJax-Span-144"><span style="display: inline-block; position: relative; width: 2.648em; height: 0px;"><span style="position: absolute; clip: rect(3.971em, 1000.39em, 5.459em, -999.997em); top: -5.068em; left: 0em;"><span class="mo" id="MathJax-Span-145" style="font-size: 135%; font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 5.073em;"></span></span><span style="position: absolute; top: -4.572em; left: 0.444em;"><span class="texatom" id="MathJax-Span-146"><span class="mrow" id="MathJax-Span-147"><span class="mo" id="MathJax-Span-148" style="font-size: 95.5%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-149" style="font-size: 95.5%; font-family: STIXGeneral-Italic;">z</span><span class="mo" id="MathJax-Span-150" style="font-size: 95.5%; font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-151" style="font-size: 95.5%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-152" style="font-size: 95.5%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span><span style="position: absolute; clip: rect(2.924em, 1000.55em, 4.191em, -999.997em); top: -2.973em; left: 50%; margin-left: -0.328em;"><span class="mtd" id="MathJax-Span-162"><span class="mrow" id="MathJax-Span-163"><span class="mn" id="MathJax-Span-164" style="font-size: 135%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span><span style="position: absolute; clip: rect(2.152em, 1004.14em, 5.514em, -999.997em); top: -4.021em; left: 5.955em;"><span style="display: inline-block; position: relative; width: 4.136em; height: 0px;"><span style="position: absolute; clip: rect(2.924em, 1004.14em, 4.467em, -999.997em); top: -4.792em; left: 50%; margin-left: -2.092em;"><span class="mtd" id="MathJax-Span-153"><span class="mrow" id="MathJax-Span-154"><span class="texatom" id="MathJax-Span-155"><span class="mrow" id="MathJax-Span-156"><span class="mtext" id="MathJax-Span-157" style="font-size: 135%; font-family: STIXGeneral-Italic;">if</span></span></span><span class="mspace" id="MathJax-Span-158" style="height: 0em; vertical-align: 0em; width: 0.444em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-159" style="font-size: 135%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-160" style="font-size: 135%; font-family: STIXGeneral-Regular; padding-left: 0.333em;">≤</span><span class="mi" id="MathJax-Span-161" style="font-size: 135%; font-family: STIXGeneral-Italic; padding-left: 0.333em;">z</span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span><span style="position: absolute; clip: rect(2.924em, 1004.14em, 4.467em, -999.997em); top: -2.973em; left: 50%; margin-left: -2.092em;"><span class="mtd" id="MathJax-Span-165"><span class="mrow" id="MathJax-Span-166"><span class="texatom" id="MathJax-Span-167"><span class="mrow" id="MathJax-Span-168"><span class="mtext" id="MathJax-Span-169" style="font-size: 135%; font-family: STIXGeneral-Italic;">if</span></span></span><span class="mspace" id="MathJax-Span-170" style="height: 0em; vertical-align: 0em; width: 0.444em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-171" style="font-size: 135%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-172" style="font-size: 135%; font-family: STIXGeneral-Regular; padding-left: 0.333em;">&gt;</span><span class="mi" id="MathJax-Span-173" style="font-size: 135%; font-family: STIXGeneral-Italic; padding-left: 0.333em;">z</span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span></span></span><span class="mo" id="MathJax-Span-174" style="vertical-align: -0.769em;"><span><span style="font-size: 135%; font-family: STIXSizeThreeSym;">}</span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.184em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.972em; border-left: 0px solid; width: 0px; height: 4.448em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mstyle mathsize="1.2em"><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">∞</mi></mrow></munderover><mfrac><mrow><msup><mi>λ</mi><mi>k</mi></msup><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>λ</mi></mrow></msup></mrow><mrow><mi>k</mi><mo>!</mo></mrow></mfrac><mo>⋅</mo><mrow><mo>{</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mo stretchy="false">(</mo><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>p</mi><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>z</mi><mo>−</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mtext class="MJX-tex-mathit" mathvariant="-tex-mathit">if</mtext></mrow><mspace width="thickmathspace"></mspace><mi>k</mi><mo>≤</mo><mi>z</mi></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mtext class="MJX-tex-mathit" mathvariant="-tex-mathit">if</mtext></mrow><mspace width="thickmathspace"></mspace><mi>k</mi><mo>&gt;</mo><mi>z</mi></mtd></mtr></mtable><mo>}</mo></mrow></mstyle><annotation encoding="application/x-tex">      \large \sum_{k=0}^{\infty} \frac{\lambda^k e^{-\lambda}}{k!} \cdot				\begin{Bmatrix}				(q/p)^{(z-k)} &amp; \textit{if}\;k\leq z\\				1 &amp; \textit{if} \; k &gt; z				\end{Bmatrix}</annotation></semantics></math></span></span></div>

Reordenándola para evitar sumar la cola infinita de la distribución…

<div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><semantics><mstyle mathsize=&quot;1.2em&quot;><mn>1</mn><mo>&amp;#x2212;</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>z</mi></mrow></munderover><mfrac><mrow><msup><mi>&amp;#x3BB;</mi><mi>k</mi></msup><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mi>&amp;#x3BB;</mi></mrow></msup></mrow><mrow><mi>k</mi><mo>!</mo></mrow></mfrac><mrow><mo>(</mo><mrow><mn>1</mn><mo>&amp;#x2212;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>p</mi><msup><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo>&amp;#x2212;</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></mrow><mo>)</mo></mrow></mstyle><annotation encoding=&quot;application/x-tex&quot;>      \large 1 &amp;#x2013; \sum_{k=0}^{z} \frac{\lambda^k e^{-\lambda}}{k!}				\left ( 1-(q/p)^{(z-k)} \right )</annotation></semantics></math>" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-175" style="width: 18.191em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.206em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.326em, 1016.04em, 5.514em, -999.997em); top: -3.635em; left: 0em;"><span class="mrow" id="MathJax-Span-176"><span class="semantics" id="MathJax-Span-177"><span class="mstyle" id="MathJax-Span-178"><span class="mrow" id="MathJax-Span-179"><span class="mn" id="MathJax-Span-180" style="font-size: 135%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-181" style="font-size: 135%; font-family: STIXGeneral-Regular; padding-left: 0.278em;">−</span><span class="munderover" id="MathJax-Span-182" style="padding-left: 0.333em;"><span style="display: inline-block; position: relative; width: 1.766em; height: 0px;"><span style="position: absolute; clip: rect(3.585em, 1001.6em, 5.9em, -999.997em); top: -5.068em; left: 0em;"><span class="mo" id="MathJax-Span-183" style="font-size: 135%; font-family: STIXSizeOneSym; vertical-align: -0.548em;">∑</span><span style="display: inline-block; width: 0px; height: 5.073em;"></span></span><span style="position: absolute; clip: rect(3.199em, 1001.55em, 4.357em, -999.997em); top: -2.477em; left: 0.113em;"><span class="texatom" id="MathJax-Span-184"><span class="mrow" id="MathJax-Span-185"><span class="mi" id="MathJax-Span-186" style="font-size: 95.5%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-187" style="font-size: 95.5%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-188" style="font-size: 95.5%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span><span style="position: absolute; clip: rect(3.31em, 1000.39em, 4.247em, -999.997em); top: -5.619em; left: 0.664em;"><span class="texatom" id="MathJax-Span-189"><span class="mrow" id="MathJax-Span-190"><span class="mi" id="MathJax-Span-191" style="font-size: 95.5%; font-family: STIXGeneral-Italic;">z</span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-192" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 3.089em; height: 0px; margin-right: 0.168em; margin-left: 0.168em;"><span style="position: absolute; clip: rect(2.648em, 1002.98em, 4.191em, -999.997em); top: -4.958em; left: 50%; margin-left: -1.485em;"><span class="mrow" id="MathJax-Span-193"><span class="msup" id="MathJax-Span-194"><span style="display: inline-block; position: relative; width: 1.16em; height: 0px;"><span style="position: absolute; clip: rect(3.971em, 1000.61em, 5.239em, -999.997em); top: -5.068em; left: 0em;"><span class="mi" id="MathJax-Span-195" style="font-size: 135%; font-family: STIXGeneral-Italic;">λ</span><span style="display: inline-block; width: 0px; height: 5.073em;"></span></span><span style="position: absolute; top: -4.572em; left: 0.609em;"><span class="mi" id="MathJax-Span-196" style="font-size: 95.5%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span></span></span><span class="msup" id="MathJax-Span-197"><span style="display: inline-block; position: relative; width: 1.822em; height: 0px;"><span style="position: absolute; clip: rect(4.302em, 1000.55em, 5.239em, -999.997em); top: -5.068em; left: 0em;"><span class="mi" id="MathJax-Span-198" style="font-size: 135%; font-family: STIXGeneral-Italic;">e</span><span style="display: inline-block; width: 0px; height: 5.073em;"></span></span><span style="position: absolute; top: -4.517em; left: 0.609em;"><span class="texatom" id="MathJax-Span-199"><span class="mrow" id="MathJax-Span-200"><span class="mo" id="MathJax-Span-201" style="font-size: 95.5%; font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-202" style="font-size: 95.5%; font-family: STIXGeneral-Italic;">λ</span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span><span style="position: absolute; clip: rect(2.924em, 1000.94em, 4.191em, -999.997em); top: -3.084em; left: 50%; margin-left: -0.548em;"><span class="mrow" id="MathJax-Span-203"><span class="mi" id="MathJax-Span-204" style="font-size: 135%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-205" style="font-size: 135%; font-family: STIXGeneral-Regular;">!</span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span><span style="position: absolute; clip: rect(0.885em, 1003.09em, 1.27em, -999.997em); top: -1.375em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.5px solid; width: 3.089em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.105em;"></span></span></span></span><span class="mrow" id="MathJax-Span-206"><span class="mo" id="MathJax-Span-207" style="vertical-align: -0.273em;"><span><span style="font-size: 135%; font-family: STIXSizeOneSym;">(</span></span></span><span class="mrow" id="MathJax-Span-208"><span class="mn" id="MathJax-Span-209" style="font-size: 135%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-210" style="font-size: 135%; font-family: STIXGeneral-Regular; padding-left: 0.278em;">−</span><span class="mo" id="MathJax-Span-211" style="font-size: 135%; font-family: STIXGeneral-Regular; padding-left: 0.278em;">(</span><span class="mi" id="MathJax-Span-212" style="font-size: 135%; font-family: STIXGeneral-Italic;">q</span><span class="texatom" id="MathJax-Span-213"><span class="mrow" id="MathJax-Span-214"><span class="mo" id="MathJax-Span-215" style="font-size: 135%; font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-216" style="font-size: 135%; font-family: STIXGeneral-Italic;">p</span><span class="msup" id="MathJax-Span-217"><span style="display: inline-block; position: relative; width: 2.648em; height: 0px;"><span style="position: absolute; clip: rect(3.971em, 1000.39em, 5.459em, -999.997em); top: -5.068em; left: 0em;"><span class="mo" id="MathJax-Span-218" style="font-size: 135%; font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 5.073em;"></span></span><span style="position: absolute; top: -4.572em; left: 0.444em;"><span class="texatom" id="MathJax-Span-219"><span class="mrow" id="MathJax-Span-220"><span class="mo" id="MathJax-Span-221" style="font-size: 95.5%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-222" style="font-size: 95.5%; font-family: STIXGeneral-Italic;">z</span><span class="mo" id="MathJax-Span-223" style="font-size: 95.5%; font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-224" style="font-size: 95.5%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-225" style="font-size: 95.5%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-226" style="vertical-align: -0.273em;"><span><span style="font-size: 135%; font-family: STIXSizeOneSym;">)</span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.64em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.972em; border-left: 0px solid; width: 0px; height: 4.448em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mstyle mathsize="1.2em"><mn>1</mn><mo>−</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>z</mi></mrow></munderover><mfrac><mrow><msup><mi>λ</mi><mi>k</mi></msup><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>λ</mi></mrow></msup></mrow><mrow><mi>k</mi><mo>!</mo></mrow></mfrac><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mo stretchy="false">(</mo><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>p</mi><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>z</mi><mo>−</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mrow><mo>)</mo></mrow></mstyle><annotation encoding="application/x-tex">      \large 1 – \sum_{k=0}^{z} \frac{\lambda^k e^{-\lambda}}{k!}				\left ( 1-(q/p)^{(z-k)} \right )</annotation></semantics></math></span></span></div>

Convertida a lenguaje de programación C…

```
#include &lt;math.h&gt;
double AttackerSuccessProbability(double q, int z)
{
	double p = 1.0 - q;
	double lambda = z * (q / p);
	double sum = 1.0;
	int i, k;
	for (k = 0; k &lt;= z; k++)
	{
		double poisson = exp(-lambda);
		for (i = 1; i &lt;= k; i++)
			poisson *= lambda / i;
		sum -= poisson * (1 - pow(q / p, z - k));
	}
	return sum;
}
```

Ejecutando algunos resultados, podemos ver que la probabilidad disminuye exponencialmente con z.

```
q=0.1
z=0    P=1.0000000
z=1    P=0.2045873
z=2    P=0.0509779
z=3    P=0.0131722
z=4    P=0.0034552  
z=5    P=0.0009137
z=6    P=0.0002428
z=7    P=0.0000647
z=8    P=0.0000173
z=9    P=0.0000046
z=10   P=0.0000012

q=0.3
z=0    P=1.0000000
z=5    P=0.1773523
z=10   P=0.0416605
z=15   P=0.0101008
z=20   P=0.0024804
z=25   P=0.0006132
z=30   P=0.0001522
z=35   P=0.0000379
z=40   P=0.0000095
z=45   P=0.0000024
z=50   P=0.0000006
```

Resolviendo para P menor que 0.1%…

```
P &lt; 0.001
q=0.10   z=5
q=0.15   z=8
q=0.20   z=11
q=0.25   z=15
q=0.30   z=24
q=0.35   z=41
q=0.40   z=89
q=0.45   z=340
```

## 12. Conclusión

Hemos propuesto un sistema para realizar transacciones electrónicas sin depender de confianza. Comenzamos con el marco habitual de monedas creadas a partir de firmas digitales, lo cual permite un firme control de la propiedad, pero que está incompleto sin una forma de prevenir el doble gasto. Para resolver esto, hemos propuesto una red peer-to-peer usando proof-of-work para realizar un registro público de las transacciones que rápidamente se hace computacionalmente inviable de cambiar para un atacante si la mayoría de la potencia CPU está controlada por nodos honestos. La red es robusta dada su simplicidad no estructurada. Los nodos trabajan todos a la vez, precisando poca coordinación. No necesitan ser identificados dado que los mensajes no se envían a ningún lugar en particular, y solo necesitan ser emitidos en base a “mejor esfuerzo”. Los nodos pueden abandonar y reincorporarse a la red a voluntad, aceptando la cadena proof-of-work como prueba de lo que ha sucedido mientras estaban ausentes. Votan con su potencia CPU, expresando su aceptación de los bloques válidos trabajando en extenderlos y descartando los bloques no válidos al rechazar trabajar en ellos. Cualesquiera reglas e incentivos necesarios pueden ser aplicados con este mecanismo de consenso.

## Referencias

[1] W. Dai, “b-money,” http://www.weidai.com/bmoney.txt, 1998.

[2] H. Massias, X.S. Avila, and J.-J. Quisquater, “Design of a secure timestamping service with minimal trust requirements,” In 20th Symposium on Information Theory in the Benelux, May 1999.

[3] S. Haber, W.S. Stornetta, “How to time-stamp a digital document,” In Journal of Cryptology, vol 3, no 2, pages 99-111, 1991.

[4] D. Bayer, S. Haber, W.S. Stornetta, “Improving the efficiency and reliability of digital time-stamping,” In Sequences II: Methods in Communication, Security and Computer Science, pages 329-334, 1993.

[5] S. Haber, W.S. Stornetta, “Secure names for bit-strings,” In Proceedings of the 4th ACM Conference on Computer and Communications Security, pages 28-35, April 1997.

[6] A. Back, “Hashcash – a denial of service counter-measure,”
http://www.hashcash.org/papers/hashcash.pdf, 2002.

[7] R.C. Merkle, “Protocols for public key cryptosystems,” In Proc. 1980 Symposium on Security and Privacy, IEEE Computer Society, pages 122-133, April 1980.

[8] W. Feller, “An introduction to probability theory and its applications,” 1957.

---

PDF available in English, Chinese (Simplified), Chinese (Traditional), Hebrew, Italian, Japanese, Russian, Spanish, and Vietnamese

<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script>
